---
description: How to audit and curate molecules from enriched_discoveries.json
---

# Molecule Audit Workflow

This workflow describes how to audit molecules generated by the simulation, categorize valid ones, and clean up trash/impossible formulas.

## Overview

The simulation generates molecules dynamically. These accumulate in `enriched_discoveries.json`. This workflow:
1. Identifies **real molecules** → adds scientific lore → moves to category files
2. Identifies **trash/impossible** → moves formulas to `blocklist.json`
3. Keeps **true emergent compounds** that are chemically valid but novel

## File Structure

```
data/molecules/
├── enriched_discoveries.json  # Raw discoveries from simulation
├── blocklist.json             # Blocked formulas (trash, impossible)
├── bio/
│   ├── amino_acids.json
│   ├── nucleobases.json
│   ├── sugars.json
│   └── metabolism.json
├── organic/
│   ├── precursors.json
│   ├── hydrocarbons.json
│   ├── nitriles.json
│   └── exotic.json
└── inorganic/
    ├── vital.json
    ├── elements.json
    └── exotic.json
```

## Step 1: Run Audit Scripts

```bash
# Remove duplicates already in category files
python scripts/cleanup_enriched.py

# Clean generic/invented names
python scripts/audit_enriched.py
python scripts/clean_wrong_names.py
python scripts/clean_prefixes.py

# Clean physically impossible formulas
python scripts/clean_impossible.py

# Count current state
python scripts/count_molecules.py
```

## Step 2: Identify Molecule Types

View remaining molecules in `enriched_discoveries.json` and classify:

### A) REAL MOLECULES (known chemistry)
**Indicators:**
- Has correct chemical name (Ácido Fórmico, Radical Hidroxilo)
- Formula matches real compound (C1H2O2 = formic acid)
- Has `category: "discovered"`

**Action:** Add to appropriate category file with comprehensive lore:
```json
{
  "identity": { "formula": "...", "names": {...}, "category": "..." },
  "lore": {
    "origin_story": "Historical/cosmic origin",
    "biological_presence": "Role in living systems",
    "utility": "Industrial/medical/gameplay use"
  },
  "gameplay": { "milestones": [...], "discovery_points": N, "difficulty": "..." }
}
```

### B) TRASH/IMPOSSIBLE (block these)
**Indicators:**
- Generic invented names: "Met-fosfoal", "Et-aminoina", "Silaal", "PhosphoHexol"
- Physically impossible formulas: C1H1, C2H1, molecules without H
- Names that don't match formula: C5H2 called "Pentano"
- Names with invented prefixes: Tio-, Phospho-, Sila- combined

**Action:** Add formula to `blocklist.json` and remove from enriched.

### C) TRUE EMERGENT (keep for gameplay)
**Indicators:**
- Chemically plausible formula (correct valences)
- Complex CHNOPS combinations from simulation
- Has `is_significant: true` or high `times_synthesized`
- Represents intermediate in simulated reactions

**Action:** Keep in `enriched_discoveries.json` as gameplay discovery.

## Step 3: Validate Remaining Emergent Molecules

For each remaining molecule, check:

1. **Valencia check**: Can atoms form these bonds?
   - C needs 4 bonds, H needs 1, O needs 2, N needs 3, S needs 2, P needs 3/5

2. **Stability check**: Is it chemically reasonable?
   - Very few H relative to C → unstable radical
   - Too many P or S without stabilization → impossible
   - No H at all with only 3-4 atoms → radical fragment

3. **Physics check**: Could simulation physics create this?
   - If formula appears frequently (`times_synthesized` > 5) → likely valid
   - If appears only once → might be physics glitch

## Step 4: Document and Commit

After each audit session:
```bash
python scripts/count_molecules.py  # Verify totals
```

Update this workflow if new patterns are found.

## Red Flags for "Broken Physics"

Molecules that suggest physics bugs:
- Extreme atom counts (P5, S6) in small molecules
- Same formula appearing with different names
- Impossible valence combinations
- Molecules that only appear once and seem random

## Scripts Reference

| Script | Purpose |
|--------|---------|
| `cleanup_enriched.py` | Remove duplicates vs category files |
| `audit_enriched.py` | Clean generic names massively |
| `clean_impossible.py` | Remove physically impossible formulas |
| `clean_wrong_names.py` | Remove incorrect name-formula pairs |
| `clean_prefixes.py` | Remove invented prefix names |
| `clean_dubious.py` | Remove dubious/complex patterns |
| `count_molecules.py` | Count totals across all files |
